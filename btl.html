<!DOCTYPE html>
<html lang="en" xmlns:mso="urn:schemas-microsoft-com:office:office" xmlns:msdt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882">
<head>
    <meta charset="UTF-8">
    <title>Module 1: Intro</title>
    <script src  = "thuvien/three.js"></script>
    <script src  = "thuvien/dat.gui.js"></script>
    <script src  = "thuvien/TrackballControls.js"></script>
    <script src  = "thuvien/OrbitControls.js"></script>
    <script src  = "thuvien/OBJLoader.js"></script>
    <script src  = "thuvien/MTLLoader.js"></script>
</head>
<body>
<div id = "screen"></div>
<script>
    function init(){
        const scene = new THREE.Scene();
        //const cam =  new THREE.OrthographicCamera(-window.innerWidth/20, window.innerWidth/20, window.innerHeight/20, -window.innerHeight/20, 500, 2000 );
        const cam = new THREE.PerspectiveCamera(60, window.innerWidth/window.innerHeight, 0.1, 3000);
        cam.position.set(0, 0, 750);
        cam.lookAt(scene.position);

        const renderer = new THREE.WebGLRenderer();
        renderer.setClearColor("#202020", 1);
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.querySelector("#screen").appendChild(renderer.domElement);
        //renderer.shadowMapEnabled = true;

        const textureLoader = new THREE.TextureLoader();
        let url = "btl/sky1.jpg";
        let texture = textureLoader.load(url);

    
        //Hinh cau thu nhat : bau troi    
        let sphereGeom = new THREE.SphereGeometry(1000,500,500,0,Math.PI,0, Math.PI)
        let sphereMat =  new THREE.MeshLambertMaterial({
            map: texture,
            side:THREE.DoubleSide,
            shadowSide:THREE.DoubleSide
        });
        let sphere = new THREE.Mesh(sphereGeom, sphereMat);
        //sphere.rotateX(Math.PI/6);
        //sphere.rotateY(Math.PI/6);
        scene.add(sphere);
        //sphere.position.set(0, -50, 10);


        //Hinh cau thu hai : nen dat
        let sphereGeom1 = new THREE.SphereGeometry(650,600,600,0,2*Math.PI,0, Math.PI)
        let sphereMat1 =  new THREE.MeshPhongMaterial({
            color:"#66B2ff",
            side:THREE.DoubleSide,
            shadowSide:THREE.DoubleSide
        });
        let sphere1 = new THREE.Mesh(sphereGeom1, sphereMat1);
        //sphere.rotateX(Math.PI/6);
        //sphere.rotateY(Math.PI/6);
        sphere1.scale.setY(0.5);
        //scene.add(sphere1);
        sphere1.position.set(0, -170, 0);


        //Model cai ban hoc
        const objLoader = new THREE.OBJLoader();

        objLoader.load("btl_model/table.obj", onLoad);
        let mat = new THREE.MeshNormalMaterial({});
        function onLoad(mesh){
            console.log(mesh);
            mesh.children.forEach(function(child){
                child.material = mat;
                //mat.side = 2;
                child.material.side = THREE.DoubleSide;
            })
            mesh.scale.setX(0.1);
            mesh.scale.setY(0.1);
            mesh.scale.setZ(0.1);
            //scene.add(mesh);
            mesh.scale.set(100,550,-1500);
        }
       


        //den chieu sang
        const pointLight = new THREE.PointLight(0xffffff, 1);
        pointLight.position.set(200, -500, -200);
        //pointLight.castShadow = true;
        scene.add(pointLight);

        let ambientLight = new THREE.AmbientLight("#888");
        //scene.add(ambientLight);

        let helper = new THREE.PointLightHelper(pointLight);
        //scene.add(helper);

        //let trackballControls = new THREE.TrackballControls(cam, renderer.domElement);
        let orbitControls = new THREE.OrbitControls(cam, renderer.domElement);

        //giao dien
        let controls = new function(){
            
        }
        const gui = new dat.GUI();
        
       
        //ve hinh
        let alpha = 0;
        //const step = 0.01;
        const clock = new THREE.Clock();
        function myRender(){
            const delta = clock.getDelta();
            //trackballControls.update(delta);
            orbitControls.update(delta);


            window.requestAnimationFrame(myRender);
            renderer.render(scene, cam);
        }
        myRender();
    }
    init();
</script>
</body>
</html>